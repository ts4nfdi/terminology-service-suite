"use client";var qe=Object.defineProperty;var Me=(n,e,t)=>e in n?qe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>Me(n,typeof e!="symbol"?e+"":e,t);import{G as O,H as D,K as Ue,L as F,a0 as X,a as S,P as c,R as ie,Y as Be,a1 as Fe,r as P,a2 as Ke,I as Ge,j as a}from"./iframe-B_2J4XoL.js";import{u as Ye}from"./useQuery-BZZAPEe4.js";import{aG as z,aH as xe,b3 as je,aT as Z,b4 as he,b5 as Pe,b6 as ee,b2 as K,ae as j,b7 as Se,b8 as Je,r as Ce,b9 as Xe,ba as Qe}from"./storyArgs-CTFaJiud.js";import{a as Ve,E as Ze}from"./title-BiV_3y4q.js";import{E as et}from"./button_icon-B85mUUXC.js";import{E as Y,j as tt}from"./loading_spinner-DEoZcQfU.js";import{E as re}from"./text-CrNs-PM8.js";import{E as nt}from"./resize_observer-Be5nz5wn.js";import{h as it,E as ae}from"./icon-DHi7ZvDN.js";import{E as rt}from"./flex_group-pBjIbpdp.js";import{E as Te}from"./flex_item-wGkeZmz_.js";import{E as te}from"./panel-DSi6Dr3L.js";import{E as at}from"./button-8d3FZpJF.js";var ot=function(e){var t=e.euiTheme;return{euiAccordion__button:O(F(e,"s")," align-items:center;display:flex;flex-grow:1;line-height:",t.size.l,";",Ue("left")," ",D("width","100%")," &:hover,&:focus{cursor:pointer;text-decoration:underline;};label:euiAccordion__button;"),disabled:O("&,&:hover{cursor:not-allowed;color:",t.colors.disabledText,";text-decoration:none;};label:disabled;"),s:O("padding:",t.size.s,";;label:s;"),m:O("padding:",t.size.base,";;label:m;"),l:O("padding:",t.size.l,";;label:l;"),arrowLeft:O(D("padding-left",0),";;label:arrowLeft;"),arrowRight:O(D("padding-right",0),";;label:arrowRight;")}},st=["buttonElement","buttonProps","buttonClassName","buttonContentClassName","isDisabled","arrowDisplay","children"],lt=["paddingSize"];function oe(){return oe=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},oe.apply(null,arguments)}function ct(n){return ht(n)||pt(n)||ut(n)||dt()}function dt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ut(n,e){if(n){if(typeof n=="string")return se(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?se(n,e):void 0}}function pt(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function ht(n){if(Array.isArray(n))return se(n)}function se(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function Ie(n,e){if(n==null)return{};var t,i,r=ft(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function ft(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}var yt=function(e){var t=e.buttonElement,i=e.buttonProps,r=e.buttonClassName,s=e.buttonContentClassName,f=e.isDisabled,d=e.arrowDisplay,u=e.children,v=Ie(e,st),y=i||{},x=y.paddingSize,w=Ie(y,lt),E=z("euiAccordion__button",r,w.className),I=z("euiAccordion__buttonContent",s),h=X(),o=ot(h),l=[o.euiAccordion__button,f&&o.disabled].concat(ct(x?[o[x],d==="left"&&o.arrowLeft,d==="right"&&o.arrowRight]:[]),[w.css]),g=t==="button";return S(t,oe({},w,v,{className:E,css:l,type:g?"button":void 0,disabled:g?f:void 0}),S("span",{className:I},u))},bt={name:"pbbcf-isOpen",styles:"transform:rotate(90deg)!important;label:isOpen;"},gt={name:"67rr15-isClosed",styles:"transform:rotate(0deg)!important;label:isClosed;"},mt={name:"ixe809-euiAccordion__arrow",styles:"flex-shrink:0;label:euiAccordion__arrow;"},vt=function(e){var t=e.euiTheme;return{euiAccordion__arrow:mt,left:O(D("margin-right",t.size.xs),";;label:left;"),right:O(D("margin-left",t.size.xs),";;label:right;"),isClosed:gt,isOpen:bt}},wt=["arrowDisplay","arrowProps","isOpen"];function le(){return le=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},le.apply(null,arguments)}function Ot(n,e){if(n==null)return{};var t,i,r=xt(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function xt(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}var Ne=function(e){var t=e.arrowDisplay,i=t===void 0?"left":t,r=e.arrowProps,s=e.isOpen,f=Ot(e,wt),d=X();if(i==="none")return null;var u=vt(d),v=[u.euiAccordion__arrow,u[i],s?u.isOpen:u.isClosed,r==null?void 0:r.css],y=z("euiAccordion__arrow",r==null?void 0:r.className);return S(et,le({color:"text"},r,f,{className:y,css:v,iconType:"arrowRight"}))};Ne.propTypes={isOpen:c.bool.isRequired};var St={name:"7vgam2-euiAccordion-optionalAction",styles:"flex-shrink:0;label:euiAccordion;label:optionalAction;"},Ct={name:"osepuu-EuiAccordionTrigger",styles:"display:flex;align-items:center;label:EuiAccordionTrigger;"},Le=function(e){var t=e.arrowDisplay,i=e.arrowProps,r=e.buttonElement,s=r===void 0?"button":r,f=e.buttonProps,d=e.buttonClassName,u=e.buttonContent,v=e.buttonContentClassName,y=e.buttonId,x=e.ariaControlsId,w=e.isDisabled,E=e.isOpen,I=e.onToggle,h=e.extraAction,o=s==="button",l=t==="none"&&!o?"left":t,g=S(Ne,{arrowDisplay:l,arrowProps:i,isOpen:E,onClick:I,isDisabled:w,"aria-controls":x,"aria-expanded":E,"aria-labelledby":y,"aria-hidden":o?"true":"false",tabIndex:o?-1:0}),m=S(yt,{buttonElement:s,buttonProps:f,buttonClassName:d,buttonContentClassName:v,arrowDisplay:l,isDisabled:w,id:y,"aria-controls":x,"aria-expanded":o?E:void 0,onClick:w?void 0:I},u),b=h&&S("div",{className:"euiAccordion__optionalAction",css:St},h);return S("div",{className:"euiAccordion__triggerWrapper",css:Ct},l==="left"&&g,m,b,l==="right"&&g)};Le.propTypes={isOpen:c.bool.isRequired,ariaControlsId:c.string.isRequired,buttonId:c.string.isRequired,onToggle:c.func.isRequired};var Tt=function(e){var t=e.isLoadingMessage,i=X(),r=i.euiTheme;return S(ie.Fragment,null,S(Y,{className:"euiAccordion__spinner",css:O({marginInlineEnd:r.size.xs},";label:EuiAccordionChildrenLoading;")}),S(re,{size:"s"},S("p",null,t!==!0?t:S(tt,{token:"euiAccordionChildrenLoading.message",default:"Loading"}))))},It={name:"1xvjonu-isLoading",styles:"align-items:center;display:flex;label:isLoading;"},Et=function(e){var t=e.euiTheme;return{euiAccordion__children:O(";label:euiAccordion__children;"),isLoading:It,xs:O("padding:",t.size.xs,";;label:xs;"),s:O("padding:",t.size.s,";;label:s;"),m:O("padding:",t.size.base,";;label:m;"),l:O("padding:",t.size.l,";;label:l;"),xl:O("padding:",t.size.xl,";;label:xl;")}},At=function(e){var t=e.euiTheme;return{euiAccordion__childWrapper:O("overflow:hidden;",xe,"{transition:",Fe.height," ",t.animation.normal," ",t.animation.resistance,",opacity ",t.animation.normal," ",t.animation.resistance,";}",Be(e),";;label:euiAccordion__childWrapper;"),noTransition:O(xe,"{transition:none;};label:noTransition;"),isClosed:O(D("height",0)," opacity:0;;label:isClosed;"),isOpen:O(D("height","auto")," opacity:1;;label:isOpen;")}},_t=["role","children","paddingSize","isLoading","isLoadingMessage","isOpen","initialIsOpen"];function ce(){return ce=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},ce.apply(null,arguments)}function Ee(n,e){return Lt(n)||Nt(n,e)||Pt(n,e)||jt()}function jt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pt(n,e){if(n){if(typeof n=="string")return Ae(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ae(n,e):void 0}}function Ae(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function Nt(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,f,d=[],u=!0,v=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(u=(i=s.call(t)).done)&&(d.push(i.value),d.length!==e);u=!0);}catch(y){v=!0,r=y}finally{try{if(!u&&t.return!=null&&(f=t.return(),Object(f)!==f))return}finally{if(v)throw r}}return d}}function Lt(n){if(Array.isArray(n))return n}function Dt(n,e){if(n==null)return{};var t,i,r=Rt(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function Rt(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}var De=function(e){var t=e.role,i=e.children,r=e.paddingSize,s=e.isLoading,f=e.isLoadingMessage,d=e.isOpen,u=e.initialIsOpen,v=Dt(e,_t),y=z("euiAccordion__children",{"euiAccordion__children-isLoading":s}),x=X(),w=Et(x),E=[w.euiAccordion__children,s&&w.isLoading,r&&r!=="none"&&w[r]],I=P.useState(!1),h=Ee(I,2),o=h[0],l=h[1],g=At(x),m=[g.euiAccordion__childWrapper,d?g.isOpen:g.isClosed,u&&!o&&d&&g.noTransition];P.useEffect(function(){u&&!d&&!o&&l(!0)},[d,u,o]);var b=P.useState(0),C=Ee(b,2),L=C[0],A=C[1],R=P.useCallback(function(N){var k=N.height;return A(Math.round(k))},[]),$=P.useMemo(function(){return{blockSize:d?L:0}},[d,L]);return S("div",ce({},v,{className:"euiAccordion__childWrapper",css:m,style:$,role:t,inert:d?void 0:""}),S(nt,{onResize:R},function(N){return S("div",{ref:N,className:y,css:E},s&&f?S(Tt,{isLoadingMessage:f}):i)}))};De.propTypes={isOpen:c.bool.isRequired};var kt=function(e){var t=e.euiTheme;return{euiAccordion:O(";label:euiAccordion;"),borders:{borders:O("&+[class*='euiAccordion-borders']{",D("border-top","none"),";};label:borders;"),horizontal:O("border-block:",t.border.thin,";;label:horizontal;"),all:O("border:",t.border.thin,";;label:all;")}}},zt=["children","className","id","role","element","buttonElement","buttonProps","buttonClassName","buttonContentClassName","buttonContent","arrowDisplay","arrowProps","extraAction","paddingSize","borders","initialIsOpen","forceState","isLoading","isLoadingMessage","isDisabled","theme"];function H(n){"@babel/helpers - typeof";return H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(n)}function de(){return de=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},de.apply(null,arguments)}function Ht(n,e){if(n==null)return{};var t,i,r=$t(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function $t(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}function Wt(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function qt(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,ke(i.key),i)}}function Mt(n,e,t){return e&&qt(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function Ut(n,e,t){return e=J(e),Bt(n,Re()?Reflect.construct(e,t||[],J(n).constructor):e.apply(n,t))}function Bt(n,e){if(e&&(H(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ft(n)}function Ft(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Re(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Re=function(){return!!n})()}function J(n){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(n)}function Kt(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&ue(n,e)}function ue(n,e){return ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},ue(n,e)}function G(n,e,t){return(e=ke(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ke(n){var e=Gt(n,"string");return H(e)=="symbol"?e:e+""}function Gt(n,e){if(H(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(H(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}var fe=(function(n){function e(){var t;Wt(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t=Ut(this,e,[].concat(r)),G(t,"state",{isOpen:t.props.forceState?t.props.forceState==="open":t.props.initialIsOpen}),G(t,"onToggle",function(){var f=t.props.forceState;if(f){var d,u,v=!t.isOpen;(d=(u=t.props).onToggle)===null||d===void 0||d.call(u,v)}else t.setState(function(y){return{isOpen:!y.isOpen}},function(){var y,x;(y=(x=t.props).onToggle)===null||y===void 0||y.call(x,t.state.isOpen)})}),G(t,"generatedId",it()()),t}return Kt(e,n),Mt(e,[{key:"isOpen",get:function(){return this.props.forceState?this.props.forceState==="open":this.state.isOpen}},{key:"render",value:function(){var i,r=this.props,s=r.children,f=r.className,d=r.id,u=r.role,v=r.element,y=v===void 0?"div":v,x=r.buttonElement,w=r.buttonProps,E=r.buttonClassName,I=r.buttonContentClassName,h=r.buttonContent,o=r.arrowDisplay,l=r.arrowProps,g=r.extraAction,m=r.paddingSize,b=r.borders,C=r.initialIsOpen;r.forceState;var L=r.isLoading,A=r.isLoadingMessage,R=r.isDisabled,$=r.theme,N=Ht(r,zt),k=z("euiAccordion",{"euiAccordion-isOpen":this.isOpen},f),W=kt($),Q=[W.euiAccordion,b!=="none"&&W.borders.borders,b!=="none"&&W.borders[b]],U=(i=w==null?void 0:w.id)!==null&&i!==void 0?i:this.generatedId;return S(y,de({className:k,css:Q},N),S(Le,{ariaControlsId:d,buttonId:U,buttonElement:y==="fieldset"?"legend":x,buttonClassName:E,buttonContent:h,buttonContentClassName:I,buttonProps:w,arrowProps:l,arrowDisplay:o,isDisabled:R,isOpen:this.isOpen,onToggle:this.onToggle,extraAction:L?S(Y,null):g}),S(De,{role:u,id:d,"aria-labelledby":U,paddingSize:m,isLoading:L,isLoadingMessage:A,isOpen:this.isOpen,initialIsOpen:C},s))}}])})(P.Component);G(fe,"defaultProps",{initialIsOpen:!1,borders:"none",paddingSize:"none",arrowDisplay:"left",isLoading:!1,isDisabled:!1,isLoadingMessage:!1,element:"div",buttonElement:"button",role:"group"});fe.propTypes={className:c.string,"aria-label":c.string,"data-test-subj":c.string,css:c.any,id:c.string.isRequired,element:c.oneOf(["div","fieldset"]),role:c.any,buttonClassName:c.string,buttonProps:c.shape({className:c.string,"aria-label":c.string,"data-test-subj":c.string,css:c.any,paddingSize:c.oneOf(["s","m","l"])}),buttonContentClassName:c.string,buttonContent:c.node,buttonElement:c.oneOf(["div","legend","button"]),arrowProps:c.any,extraAction:c.node,initialIsOpen:c.bool,onToggle:c.func,paddingSize:c.any,arrowDisplay:c.oneOf(["left","right","none"]),borders:c.oneOf(["horizontal","all","none"]),forceState:c.oneOf(["closed","open"]),isLoading:c.bool,isLoadingMessage:c.oneOfType([c.bool.isRequired,c.node.isRequired]),isDisabled:c.bool};var Yt=Ke(fe),Jt={name:"1qhojri-inherit",styles:"font-size:inherit;label:inherit;"},Xt={name:"j8uhck-euiHealth",styles:"display:inline-block;label:euiHealth;"},Qt=function(e){return{euiHealth:Xt,xs:O(F(e,"xs"),";;label:xs;"),s:O(F(e,"s"),";;label:s;"),m:O(F(e,"m"),";;label:m;"),inherit:Jt}},Vt=["children","className","color","textSize"];function pe(){return pe=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},pe.apply(null,arguments)}function Zt(n,e){if(n==null)return{};var t,i,r=en(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function en(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}var M=function(e){var t=e.children,i=e.className,r=e.color,s=e.textSize,f=s===void 0?"s":s,d=Zt(e,Vt),u=Ge(Qt),v=[u.euiHealth,u[f]],y=z("euiHealth",i);return S("div",pe({css:v,className:y},d),S(rt,{gutterSize:"xs",alignItems:"center",responsive:!1},S(Te,{grow:!1},S(ae,{type:"dot",color:r})),S(Te,{grow:!1},t)))};M.propTypes={className:c.string,"aria-label":c.string,"data-test-subj":c.string,css:c.any,color:c.oneOfType([c.string.isRequired,c.any.isRequired]),textSize:c.any};function _e(n){return{iri:n["@id"],label:n.prefLabel,hasChildren:n.hasChildren,parents:[]}}class ye{constructor(e,t){B(this,"axiosInstance");B(this,"apiKey");this.axiosInstance=je.create({baseURL:e,headers:{Accept:"application/json"}}),this.apiKey=t,this.axiosInstance.interceptors.request.use(i=>(i.params=i.params||{},i.params.apikey=this.apiKey,i.params.format="json",i))}async makeCall(e,t){return(await this.axiosInstance.get(e,t)).data}async buildHierarchyWithIri(e){const{iri:t,ontologyId:i,entityType:r,showSiblingsOnInit:s}=e;if(!i)throw Error("ontologyId has to be specified for OntoPortal API.");if(!r)throw Error("entityType has to be specified for OntoPortal API.");const f=[],d=new Map,u=new Map,v=new Set,y=new Set;function x(h){if(d.set(h["@id"],_e(h)),h.hasChildren&&h.children.length>0){u.set(h["@id"],h.children.map(o=>({childIri:o["@id"]}))),v.add(h["@id"]),y.add(h["@id"]);for(const o of h.children)x(o)}}if(t){const h=await this.makeCall(`/ontologies/${i.toUpperCase()}/${Z(r,!1)}/${encodeURIComponent(t)}/tree`,{params:{include:"@id,prefLabel,hasChildren,children",language:"EN"}});for(const o of h)f.push(o["@id"]),y.add(o["@id"]),x(o);y.add(t)}else{const h=await this.makeCall(`/ontologies/${i.toUpperCase()}/${Z(r,!1)}/roots`,{params:{include:"@id,prefLabel,hasChildren",language:"EN"}});for(const o of h)f.push(o["@id"]),y.add(o["@id"])}function w(h,o){o.add(h.iri);const l=new Pe(h),g=u.get(h.iri)||[];if(s)for(const m of g){if(o.has(m.childIri)){console.error(`Cyclic tree at entity "${m.childIri}".`);continue}l.addChild(w(d.get(m.childIri),o))}else for(const m of g){if(o.has(m.childIri)){console.error(`Cyclic tree at entity "${m.childIri}".`);continue}y.has(m.childIri)&&l.addChild(w(d.get(m.childIri),o))}return l.loadedChildren.length>0&&(l.expanded=!0),o.delete(h.iri),l}const E=new Set,I=f.map(h=>w(d.get(h),E)).sort((h,o)=>(h.entityData.label||h.entityData.iri).localeCompare(o.entityData.label||o.entityData.iri));return new he({parentChildRelations:u,entitiesData:d,allChildrenPresent:v,roots:I,api:new ye(this.axiosInstance.getUri(),this.apiKey),ontologyId:i,mainEntityIri:t,keepExpansionStates:e.keepExpansionStates,entityType:r})}async loadHierarchyChildren(e){const{nodeToExpand:t,ontologyId:i,entityType:r}=e;if(r==null)throw Error("entityType has to be provided to load children in an OntoPortal hierarchy.");return(await this.makeCall(`/ontologies/${i.toUpperCase()}/${Z(r,!1)}/${encodeURIComponent(t.entityData.iri)}/children`,{params:{include:"@id,prefLabel,hasChildren",language:"EN"}})).collection.map(f=>_e(f))}}class ne{static fromTopConcept(e){return{iri:e.uri,label:e.label,hasChildren:e.hasChildren,parents:[]}}static fromHierarchyResult(e){return{iri:e.uri,label:e.prefLabel,hasChildren:e.narrower!=null&&e.narrower.length>0,parents:K.fromJson(e.broader)}}static fromPrefAndUriAndChildren(e,t){return{iri:e.uri,label:e.prefLabel,hasChildren:e.hasChildren,parents:K.fromJson(t)}}static fromLabelAndUriAndChildren(e,t){return{iri:e.uri,label:e.label,hasChildren:e.hasChildren,parents:K.fromJson(t)}}}class be{constructor(e){B(this,"axiosInstance");this.axiosInstance=je.create({baseURL:e,headers:{Accept:"application/json"}})}async makeCall(e,t){return(await this.axiosInstance.get(e,t)).data}async buildHierarchyWithIri(e){var I,h;const{iri:t,ontologyId:i,showSiblingsOnInit:r,parameter:s}=e;if(!i)throw Error("ontologyId has to be specified for SKOS API.");const f=[],d=new Map,u=new Map,v=new Set,y=new Set;if(t){const o=await this.makeCall(`/${i}/hierarchy`,{params:{uri:t,lang:"en",format:"application/json",...ee(s)}}).then(l=>Object.keys(l.broaderTransitive).map(g=>l.broaderTransitive[g]));for(const l of o){const g=ne.fromHierarchyResult(l);u.set(g.iri,g),l.top&&f.push(g.iri),r||y.add(g.iri)}for(const l of o)if(l.narrower!=null){const g=[];for(const m of l.narrower){let b=u.get(m.uri);b==null?(b=ne.fromLabelAndUriAndChildren(m,[l.uri]),u.set(b.iri,b)):(I=b==null?void 0:b.parents)!=null&&I.map(C=>C.value).includes(l.uri)||b!=null&&b.parents&&((h=b==null?void 0:b.parents)==null||h.push(...K.fromJson(l.uri))),g.push(b)}g.sort((m,b)=>(m.label||m.iri).localeCompare(b.label||b.iri)),d.set(l.uri,g.map(m=>({childIri:m.iri}))),v.add(l.uri)}}else{const o=await this.makeCall(`/${i}/topConcepts`,{params:{lang:"en",format:"application/json",...ee(s)}}).then(l=>l.topconcepts);for(const l of o)f.push(l.uri)}function x(o,l){l.add(o.iri);const g=new Pe(o),m=d.get(o.iri)||[];if(r)for(const b of m){if(l.has(b.childIri)){console.error(`Cyclic tree at entity "${b.childIri}".`);continue}const C=u.get(b.childIri);C!=null&&g.addChild(x(C,l))}else for(const b of m){if(l.has(b.childIri)){console.error(`Cyclic tree at entity "${b.childIri}".`);continue}const C=u.get(b.childIri);C!=null&&y.has(b.childIri)&&g.addChild(x(C,l))}return g.loadedChildren.length>0&&(g.expanded=!0),l.delete(o.iri),g}const w=new Set,E=f.map(o=>x(u.get(o),w)).sort((o,l)=>(o.entityData.label||o.entityData.iri).localeCompare(l.entityData.label||l.entityData.iri));return new he({parentChildRelations:d,entitiesData:u,allChildrenPresent:v,roots:E,api:new be(this.axiosInstance.getUri()),ontologyId:i,mainEntityIri:t,keepExpansionStates:e.keepExpansionStates,parameter:s})}async loadHierarchyChildren(e){const{nodeToExpand:t,ontologyId:i,parameter:r}=e;return(await this.makeCall(`/${i}/children`,{params:{uri:t.entityData.iri,lang:"en",format:"application/json",...ee(r)}})).narrower.map(f=>ne.fromPrefAndUriAndChildren(f,[t.entityData.iri]))}}function tn(n){var me,ve,we,Oe;const{apiUrl:e,backendType:t,apiKey:i,onNavigateToEntity:r,onNavigateToOntology:s,iri:f,targetIri:d,ontologyId:u,entityType:v,includeObsoleteEntities:y=j.INCLUDE_OBSOLETE_ENTITIES,preferredRoots:x=j.PREFERRED_ROOTS,keepExpansionStates:w=j.KEEP_EXPANSION_STATES,showSiblingsOnInit:E=j.SHOW_SIBLINGS_ON_INIT,useLegacy:I=j.USE_LEGACY,hierarchyWrap:h=j.WRAP,showHeader:o=j.SHOW_HEADER,showComparisonTitleInHeader:l=j.SHOW_COMPARISON_TITLE_IN_HEADER,className:g,parameter:m}=n,b=g||"ts4nfdi-hierarchy-style",[C,L]=P.useState(f),[A,R]=P.useState(d);P.useEffect(()=>{!f&&d?(L(d),R(void 0)):(L(f),R(d))},[f,d]);function $(p){let T=p.entityData.definedBy||[];return T.includes(p.ontologyId)&&(T=[]),a.jsxs("span",{style:{position:"relative",left:"16px",lineHeight:"20px"},children:[a.jsxs("span",{className:p.highlightColor?"highlight":void 0,style:{background:Xe(p.highlightColor,.2)},children:[p.childRelationToParent=="http://purl.obolibrary.org/obo/BFO_0000050"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"surroundCircle",children:" P "})," "]}),p.childRelationToParent=="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"surroundCircle",children:"I"})," "]}),a.jsx("a",{onClick:()=>{typeof p.onNavigateToEntity=="function"&&p.onNavigateToEntity(p.ontologyId,p.entityType||"",p.entityData)},style:{textAlign:"left",color:"unset",cursor:"pointer"},children:a.jsx("span",{style:{color:p.entityData.color},children:p.entityData.label||p.entityData.iri})})]}),a.jsxs("span",{children:[T.length>0&&a.jsx(a.Fragment,{children:T.map(q=>a.jsxs("span",{children:[" ",a.jsx("button",{onClick:()=>{p.onNavigateToOntology&&p.onNavigateToOntology(q,p.entityType||"",p.entityData)},children:a.jsx("span",{className:"ontology-badge",children:q.toUpperCase()})})]},Ce()))}),p.entityData.numDescendants!=null&&p.entityData.numDescendants>0&&a.jsxs("span",{style:{color:"gray"},children:[" ","(",p.entityData.numDescendants.toLocaleString(),")"]})]})]})}const[,N]=P.useReducer(p=>p+1%Number.MAX_SAFE_INTEGER,0),[k,W]=ie.useState(!1),[Q,U]=ie.useState(!1),V=P.useMemo(()=>{switch(t){case"ols":return new Se(e);case"skosmos":return new be(e);case"ontoportal":return new ye(e,i||"");default:return new Se(e)}},[e,t,i]),{data:_,isSuccess:ze}=Ye(["hierarchySemLookP",C,v,u,x,y,w,E,I,m,A,k],async function(){return A&&C?Qe(await V.buildHierarchyWithIri({ontologyId:u,iri:C,entityType:v,preferredRoots:x,includeObsoleteEntities:y,keepExpansionStates:w,showSiblingsOnInit:!1,useLegacy:I,parameter:m}),await V.buildHierarchyWithIri({ontologyId:u,iri:A,entityType:v,preferredRoots:x,includeObsoleteEntities:y,keepExpansionStates:w,showSiblingsOnInit:!1,useLegacy:I,parameter:m})):await V.buildHierarchyWithIri({ontologyId:u,iri:C,entityType:v,preferredRoots:x,includeObsoleteEntities:y,keepExpansionStates:w,showSiblingsOnInit:E,useLegacy:I,parameter:m})},{refetchOnWindowFocus:!1}),He=P.useCallback(p=>{if(!(_ instanceof he))throw Error("Hierarchy object was undefined while trying to expand a tree node. This should never happen.");_.entityType&&Je(_.entityType)||(p.expanded=!p.expanded,p.expanded?(p.loading=!0,N(),_.fetchInformationForExpansion(p).then(()=>{p.loading=!1,N()})):(N(),_.closeNode(p)))},[_]);function ge(p,T,q){return a.jsxs("div",{children:[a.jsxs("div",{style:{position:"relative"},children:[a.jsx("div",{style:{position:"absolute",top:T.expanded?"-2px":"0",left:T.expanded?"-1px":"-3px"},children:T.entityData.hasChildren?a.jsxs("button",{style:{},onClick:()=>{He(T)},children:[a.jsx(ae,{type:T.expanded?"arrowDown":"arrowRight",size:"s"})," "]}):a.jsx(ae,{type:"empty"})}),a.jsx("div",{className:"lineNodeInlet"}),a.jsx("div",{className:q?"lineAfterNodeInlet":""}),a.jsx($,{entityData:T.entityData,childRelationToParent:T.childRelationToParent,ontologyId:p.ontologyId,entityType:p.entityType,onNavigateToEntity:typeof r=="function"?r:()=>{},onNavigateToOntology:typeof s=="function"?s:()=>{},highlightColor:T.entityData.iri==C?j.COLOR_A:T.entityData.iri==A?j.COLOR_B:""})]}),T.expanded&&a.jsx("ul",{style:{marginBlockEnd:"0",marginInlineStart:"5px"},children:T.loading?a.jsx(Y,{style:{position:"relative",left:"13px",top:"5px"}}):T.loadedChildren.map(($e,We)=>a.jsx("div",{className:q?"outerLine":"",style:{paddingLeft:"1rem"},children:ge(p,$e,We<T.loadedChildren.length-1)},Ce()))})]})}return a.jsx("div",{className:b,children:ze&&_!=null?a.jsxs("span",{children:[o&&a.jsx(te,{style:{overflowX:"auto",overflowY:"hidden"},borderRadius:"none",paddingSize:"s",children:a.jsxs("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[a.jsxs("span",{children:[C&&A&&l&&a.jsx(Ve,{size:"s",children:a.jsxs("h2",{style:{maxWidth:"350px",whiteSpace:"normal",wordBreak:"break-word"},children:["Comparison of"," ",a.jsx("i",{children:((me=_.entitiesData.get(C))==null?void 0:me.label)||f})," ","and"," ",a.jsx("i",{children:((ve=_.entitiesData.get(A))==null?void 0:ve.label)||A})]})}),C&&A&&a.jsxs("span",{children:[a.jsx(Ze,{size:"s"}),a.jsx(Yt,{buttonContent:Q?"Hide Legend":"Show Legend",id:"",onToggle:p=>U(p),children:a.jsxs(re,{style:{paddingLeft:".3em"},children:[a.jsx(M,{color:j.COLOR_UNION,children:"Common subtree"}),a.jsx("br",{}),a.jsxs(M,{color:j.COLOR_A,children:["Subtree exclusive to ",'"',((we=_.entitiesData.get(C))==null?void 0:we.label)||C,'"']}),a.jsx("br",{}),a.jsxs(M,{color:j.COLOR_B,children:["Subtree exclusive to ",'"',((Oe=_.entitiesData.get(A))==null?void 0:Oe.label)||A,'"']}),a.jsx("br",{}),a.jsx(M,{children:"Subtree independent of both"})]})})]})]}),a.jsx(at,{size:"s",onClick:()=>W(!k),children:"Reset"})]})}),a.jsx(te,{"data-testid":"hierarchy",style:{overflowX:"auto",overflowY:"hidden"},hasShadow:!1,hasBorder:!0,borderRadius:"none",children:a.jsx("span",{children:a.jsx(re,{style:{whiteSpace:h?"wrap":"nowrap"},children:_.roots.map((p,T)=>ge(_,p,T<_.roots.length-1))})})})]}):a.jsx(te,{children:a.jsx(Y,{})})})}tn.__docgenInfo={description:"",methods:[],displayName:"HierarchyWidget",props:{className:{required:!1,tsType:{name:"string"},description:"CSS class for styling"},apiUrl:{required:!0,tsType:{name:"string"},description:""},apiKey:{required:!1,tsType:{name:"string"},description:""},backendType:{required:!1,tsType:{name:"string"},description:""},hierarchyWrap:{required:!1,tsType:{name:"boolean"},description:""},targetIri:{required:!1,tsType:{name:"string"},description:""},showHeader:{required:!1,tsType:{name:"boolean"},description:""},showComparisonTitleInHeader:{required:!1,tsType:{name:"boolean"},description:""},entityType:{required:!1,tsType:{name:"unknown[number]",raw:"(typeof entityTypeNames)[number]"},description:""},ontologyId:{required:!1,tsType:{name:"string"},description:""},includeObsoleteEntities:{required:!1,tsType:{name:"boolean"},description:""},useLegacy:{required:!1,tsType:{name:"boolean"},description:""},parameter:{required:!1,tsType:{name:"string"},description:""},preferredRoots:{required:!1,tsType:{name:"boolean"},description:""},keepExpansionStates:{required:!1,tsType:{name:"boolean"},description:""},showSiblingsOnInit:{required:!1,tsType:{name:"boolean"},description:""},iri:{required:!1,tsType:{name:"string"},description:""},onNavigateToEntity:{required:!1,tsType:{name:"union",raw:`| ((ontologyId: string, entityType?: string, entity?: EntityData) => void)
| string`,elements:[{name:"unknown"},{name:"string"}]},description:`This function is called every time an entity link is clicked
@param ontologyId obtains the ontologyId of the current ontology
@param entityType obtains the entityType of the clicked entity
@param entity.iri obtains the iri of the clicked entity
@param entity.label obtains the label of the clicked entity
@param entity.definedBy obtains the list of ontologies the clicked entity is defined in (only OLS)
@param entity.hasChildren obtains a boolean indicating whether the clicked entity has child entities
@param entity.numDescendants obtains the number of hierarchical descendants of the clicked entity (only OLS)
@param entity.parents obtains the list of parent entities of the clicked entity (only OLS, Skosmos)`},onNavigateToOntology:{required:!1,tsType:{name:"union",raw:`| ((ontologyId: string, entityType?: string, entity?: EntityData) => void)
| string`,elements:[{name:"unknown"},{name:"string"}]},description:`This function is called every time an entity link is clicked
@param ontologyId obtains the ontologyId of the clicked badge
@param entityType obtains the entityType of the clicked badge
@param entity.iri obtains the iri of the clicked badge (can be empty)
@param entity.label obtains the label of the clicked badge
@param entity.definedBy obtains the list of ontologies the clicked entity is defined in (only OLS)
@param entity.hasChildren obtains a boolean indicating whether the clicked entity has child entities
@param entity.numDescendants obtains the number of hierarchical descendants of the clicked entity (only OLS)
@param entity.parents obtains the list of parent entities of the clicked entity (only OLS, Skosmos)`}}};export{M as E,tn as H};
