import{j as e}from"./index-Bl-ZOWkZ.js";import{b2 as z,aR as N,U as d,R as w}from"./storyArgs-CNybPO01.js";import{D as k}from"./globals-BQAFDkgj.js";import{E as C}from"./ExpandableOntologyBadgeList-DuPGoLJ-.js";import{B as J}from"./OntologyBadge-QeaUz3Wa.js";import{E as U}from"./icon-CE3ukyQW.js";import{T as W}from"./Tooltip-d9QE-lRt.js";function X(){return e.jsx("span",{style:{margin:"0 0.15em"}})}function I({parentEntity:l,linkedEntities:c,iri:s,showBadges:o=k,onNavigates:n}){const r=c.getLabelForIri(s)||s.split("/").pop()||s,t=c.get(s),m=l.getOntologyId();if(l.getType()!=="ontology"&&s===(l==null?void 0:l.getIri()))return e.jsx("span",{className:"highlight",children:l.getLabel()});if(!t)return s.startsWith("http")?e.jsx("a",{className:"clickable",href:s,children:r}):e.jsx("span",{children:r});const j=t.definedBy?t.definedBy.filter(p=>p!==m):[],x=t.type?z(t.type):l.getType();return j.length===1?t.hasLocalDefinition?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"clickable",onClick:()=>{typeof n.onNavigateToEntity=="function"&&n.onNavigateToEntity(m,x,{iri:s,label:r})},children:r}),o?e.jsxs(e.Fragment,{children:[" ",e.jsx(C,{iri:s,label:r,ontolist:j,onNavigateToOntology:n.onNavigateToOntology,entityType:x})]}):e.jsx(e.Fragment,{})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"clickable",onClick:()=>{typeof n.onNavigateToEntity=="function"&&n.onNavigateToEntity(j[0],x,{iri:s,label:r})},children:r}),o?e.jsxs(e.Fragment,{children:[" ",e.jsx(C,{iri:s,label:r,ontolist:j,onNavigateToOntology:n.onNavigateToOntology,entityType:x})]}):e.jsx(e.Fragment,{})]}):j.length>1?t.hasLocalDefinition?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"clickable",onClick:()=>{typeof n.onNavigateToEntity=="function"&&n.onNavigateToEntity(m,x,{iri:s,label:r})},children:r}),o?e.jsxs(e.Fragment,{children:[" ",e.jsx(C,{iri:s,label:r,ontolist:j,onNavigateToOntology:n.onNavigateToOntology,entityType:x})]}):e.jsx(e.Fragment,{})]}):e.jsxs(e.Fragment,{children:[e.jsx("a",{className:"clickable",href:s,children:r}),o&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsxs(J,{onClick:()=>{typeof n.onNavigateToDisambiguate=="function"&&n.onNavigateToDisambiguate(x,{iri:s,label:r})},children:[e.jsx(U,{type:"search",size:"s"})," ",j.length," ","ontologies"]})]})]}):t.hasLocalDefinition?e.jsx(e.Fragment,{children:e.jsx("button",{className:"clickable",onClick:()=>{typeof n.onNavigateToEntity=="function"&&n.onNavigateToEntity(m,x,{iri:s,label:r})},children:r})}):parseInt(t.numAppearsIn)>0?e.jsxs(e.Fragment,{children:[e.jsx("a",{className:"clickable",href:s,children:r}),o&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsxs(J,{onClick:()=>{typeof n.onNavigateToDisambiguate=="function"&&n.onNavigateToDisambiguate(x,{iri:s,label:r})},children:[e.jsx(U,{type:"search",size:"s"})," ",t.numAppearsIn," ",parseInt(t.numAppearsIn)>1?"ontologies":"ontology"]})]})]}):e.jsx(e.Fragment,{children:e.jsx("a",{className:"clickable",href:t.url||s,children:r})})}function h({parentEntity:l,linkedEntities:c,currentResponsePath:s,showBadges:o=k,onNavigates:n}){let r=e.jsx(e.Fragment,{});if(c=c.mergeWith(s.linkedEntities),typeof s=="string")r=e.jsx(I,{parentEntity:l,linkedEntities:c,iri:s,showBadges:o,onNavigates:n});else if(typeof s=="object"&&!Array.isArray(s)&&Array.isArray(s.type)&&s.type.indexOf("reification")!==-1)r=e.jsx(Q,{parentEntity:l,reified:N.fromJson(s)[0],showBadges:o,onNavigates:n});else{const t=s["http://www.w3.org/2002/07/owl#someValuesFrom"],m=s["http://www.w3.org/2002/07/owl#allValuesFrom"],j=d(s["http://www.w3.org/2002/07/owl#intersectionOf"]),x=d(s["http://www.w3.org/2002/07/owl#unionOf"]),p=s["http://www.w3.org/2002/07/owl#hasValue"],O=s["http://www.w3.org/2002/07/owl#minCardinality"]||s["http://www.w3.org/2002/07/owl#minQualifiedCardinality"],F=s["http://www.w3.org/2002/07/owl#maxCardinality"]||s["http://www.w3.org/2002/07/owl#maxQualifiedCardinality"],b=s["http://www.w3.org/2002/07/owl#cardinality"]||s["http://www.w3.org/2002/07/owl#qualifiedCardinality"],a=s["http://www.w3.org/2002/07/owl#hasSelf"],f=s["http://www.w3.org/2002/07/owl#complementOf"],g=d(s["http://www.w3.org/2002/07/owl#oneOf"]),y=s["http://www.w3.org/2002/07/owl#inverseOf"],T=s["http://www.w3.org/2002/07/owl#onProperty"],A=s["http://www.w3.org/2002/07/owl#onDatatype"];if(A){const i=[];i.push(e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:A,showBadges:o,onNavigates:n}));const u=d(s["http://www.w3.org/2002/07/owl#withRestrictions"]);if(u.length>0){i.push(e.jsx(e.Fragment,{children:"["}));let S=!0;for(const L of u){S?S=!1:i.push(e.jsx(e.Fragment,{children:", "}));const D=L["http://www.w3.org/2001/XMLSchema#minExclusive"],R=L["http://www.w3.org/2001/XMLSchema#minInclusive"],V=L["http://www.w3.org/2001/XMLSchema#maxExclusive"],M=L["http://www.w3.org/2001/XMLSchema#maxInclusive"];D?i.push(e.jsxs(e.Fragment,{children:["> ",D]})):R?i.push(e.jsxs(e.Fragment,{children:["≥ ",R]})):V?i.push(e.jsxs(e.Fragment,{children:["< ",V]})):M&&i.push(e.jsxs(e.Fragment,{children:["≤ ",M]}))}i.push(e.jsx(e.Fragment,{children:"]"}))}r=e.jsx(e.Fragment,{children:i.map(S=>e.jsx(e.Fragment,{children:S}))})}else if(t)r=e.jsxs(e.Fragment,{children:[e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:T,showBadges:o,onNavigates:n}),e.jsx("i",{style:{color:"purple"},children:" some "}),e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:d(t)[0],showBadges:o,onNavigates:n})]});else if(m)r=e.jsxs(e.Fragment,{children:[e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:T,showBadges:o,onNavigates:n}),e.jsx("i",{style:{color:"purple"},children:" only "}),e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:d(m)[0],showBadges:o,onNavigates:n})]});else if(j.length>0){const i=[e.jsx("span",{className:"text-neutral-default",children:"("},w())];for(const u of j)i.length>1&&i.push(e.jsx("i",{children:" and "})),i.push(e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:u,showBadges:o,onNavigates:n}));i.push(e.jsx("span",{className:"text-neutral-default",children:")"})),r=e.jsx("span",{children:i.map(u=>e.jsx(e.Fragment,{children:u}))})}else if(x.length>0){const i=[e.jsx("span",{className:"text-neutral-default",children:"("},w())];for(const u of x)i.length>1&&i.push(e.jsx("i",{children:" or "})),i.push(e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:u,showBadges:o,onNavigates:n}));i.push(e.jsx("span",{className:"text-neutral-default",children:")"})),r=e.jsx("span",{children:i.map(u=>e.jsx("span",{children:u},w()))})}else if(p)r=e.jsxs(e.Fragment,{children:[e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:T,showBadges:o,onNavigates:n}),e.jsx("i",{style:{color:"purple"},children:" value "}),e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:d(p)[0],showBadges:o,onNavigates:n})]});else if(O)r=e.jsxs(e.Fragment,{children:[e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:T,showBadges:o,onNavigates:n}),e.jsx("i",{style:{color:"purple"},children:" min "}),e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:d(O)[0],showBadges:o,onNavigates:n})]});else if(F)r=e.jsxs(e.Fragment,{children:[e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:T,showBadges:o,onNavigates:n}),e.jsx("i",{style:{color:"purple"},children:" max "}),e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:d(F)[0],showBadges:o,onNavigates:n})]});else if(b)r=e.jsxs(e.Fragment,{children:[e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:T,showBadges:o,onNavigates:n}),e.jsx("i",{style:{color:"purple"},children:" exactly "}),e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:d(b)[0],showBadges:o,onNavigates:n})]});else if(a)r=e.jsxs(e.Fragment,{children:[e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:T,showBadges:o,onNavigates:n}),e.jsx("i",{style:{color:"purple"},children:" Self "}),e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:d(a)[0],showBadges:o,onNavigates:n})]});else if(f)r=e.jsxs(e.Fragment,{children:[e.jsx("i",{children:"not "}),e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:d(f)[0],showBadges:o,onNavigates:n})]});else if(g.length>0){const i=[e.jsx("span",{className:"text-neutral-default",children:"{"},w())];for(const u of g)i.length>1&&i.push(e.jsx("span",{className:"text-neutral-default",children:", "},w())),i.push(e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:u,showBadges:o,onNavigates:n}));i.push(e.jsx("span",{className:"text-neutral-default",children:"}"})),r=e.jsx("span",{children:i.map(u=>e.jsx("span",{children:u},w()))})}else y&&(r=e.jsxs(e.Fragment,{children:[e.jsx("i",{style:{color:"purple"},children:"inverse "}),e.jsx("span",{className:"text-neutral-default",children:"("},w()),e.jsx(h,{parentEntity:l,linkedEntities:c,currentResponsePath:y,showBadges:o,onNavigates:n}),e.jsx("span",{className:"text-neutral-default",children:")"},w())]}))}return r}function Q({parentEntity:l,reified:c,showBadges:s=k,onNavigates:o}){function n({value:t}){const m=l.getLinkedEntities();function j(x){const p=[];if(m)for(const a of Object.keys(m.linkedEntities))for(let f=x.indexOf(a,0);f!==-1;f=x.indexOf(a,f))p.push({start:f,end:f+a.length,link:e.jsx(I,{parentEntity:l,linkedEntities:m,iri:a,showBadges:s,onNavigates:o})}),f+=a.length;const O=/[A-z]+:\/\/[^\s]+/g;for(let a=O.exec(x);a;a=O.exec(x)){const f=a[0];p.push({start:a.index,end:a.index+f.length,link:e.jsx("span",{children:e.jsx("a",{className:"clickable",href:f,children:f})},w())})}p.sort((a,f)=>a.start-f.start);e:for(let a=0;a<p.length;){for(let f=a+1;f<p.length;++f){const g=p[a],y=p[f];if(g!==y&&g.end>=y.start&&y.end>=g.start){g.end-g.start<y.end-y.start?p.splice(a,1):p.splice(f,1);continue e}}++a}if(p.length===0)return e.jsx(e.Fragment,{children:x});const F=[];let b=0;for(const a of p)F.push(e.jsx("span",{children:x.substring(b,a.start)},w())),F.push(a.link),b=a.end;return F.push(e.jsx("span",{children:x.slice(b)},w())),e.jsx(e.Fragment,{children:F})}if(Object.keys(m.linkedEntities).length==0){if(typeof t=="string")return j(t.toString());if(typeof t=="object"&&t["http://www.w3.org/1999/02/22-rdf-syntax-ns#type"]!=null)switch(t["http://www.w3.org/1999/02/22-rdf-syntax-ns#type"]){case"http://www.w3.org/2008/05/skos-xl#Label":return e.jsx(e.Fragment,{children:t["http://www.w3.org/2008/05/skos-xl#literalForm"].value});case"http://purl.org/vocab/changeset/schema#ChangeSet":return e.jsxs(e.Fragment,{children:[t["http://purl.org/vocab/changeset/schema#createdDate"].value,": ",t["http://purl.org/vocab/changeset/schema#changeReason"].value]});default:return console.error(`Unknown rdf syntax type: ${t["http://www.w3.org/1999/02/22-rdf-syntax-ns#type"]}`),e.jsx(e.Fragment,{children:JSON.stringify(t)})}else return console.error(`Unknown entry information format: ${t}`),e.jsx(e.Fragment,{children:JSON.stringify(t)})}else return m.get(t)?e.jsx(I,{parentEntity:l,linkedEntities:m,iri:t,showBadges:s,onNavigates:o}):typeof t!="string"?l.getType()=="ontology"?e.jsx(e.Fragment,{children:JSON.stringify(t)}):e.jsx(h,{parentEntity:l,linkedEntities:m,currentResponsePath:t,showBadges:s,onNavigates:o}):j(t.toString())}function r({axiomsDict:t}){const m=Object.keys(t).map(j=>{const x=l.getLinkedEntities().getLabelForIri(j)||j;return x?"*"+t[j]+" ("+x+")":""}).join(`
`);return e.jsx(W,{text:m})}return e.jsxs(e.Fragment,{children:[e.jsx(n,{value:c.value}),c.hasMetadata()&&e.jsxs(e.Fragment,{children:[" ",e.jsx(r,{axiomsDict:c.getMetadata()})]})]})}export{h as C,I as E,Q as R};
