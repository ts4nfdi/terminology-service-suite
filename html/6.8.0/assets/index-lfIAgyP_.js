var We=Object.defineProperty;var $e=(t,e,n)=>e in t?We(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var B=(t,e,n)=>$e(t,typeof e!="symbol"?e+"":e,n);import{R as ne,r as P,j as o,c as Me}from"./client-hNkKQuBU.js";import{aK as C,aL as R,aU as Ue,aM as Be,aN as M,aV as Q,aP as I,aQ as f,n as G,aW as Fe,aX as ve,aY as qe,aZ as Ke,a_ as Ge,a$ as Ae,b0 as V,b1 as de,b2 as _e,b3 as Z,aT as q,Q as Je,k as Qe,l as Xe,ak as j,b4 as we,b5 as Ye,J as xe,b6 as Ve,b7 as Ze}from"./QueryClientProvider-Cv6DMAwY.js";import{u as et}from"./useQuery-D80UYlTP.js";import{a as tt,E as nt}from"./title-BjAFpbjY.js";import{E as it}from"./button_icon-yDZ-49HD.js";import{E as ie}from"./text-Dj3fvmL0.js";import{E as rt}from"./resize_observer-DE6M6jJJ.js";import{h as ot,E as Ce}from"./icon-Dbgqo2NT.js";import{E as F}from"./health-6JZd6YNG.js";import{E as ee}from"./panel-pG-TvU-E.js";import{E as at}from"./button-Dca_e4tp.js";var st=function(e){var n=e.euiTheme;return{euiAccordion__button:C(Be(e,"s")," align-items:center;display:flex;flex-grow:1;line-height:",n.size.l,";",Ue("left")," ",R("width","100%")," &:hover,&:focus{cursor:pointer;text-decoration:underline;};label:euiAccordion__button;"),disabled:C("&,&:hover{cursor:not-allowed;color:",n.colors.disabledText,";text-decoration:none;};label:disabled;"),s:C("padding:",n.size.s,";;label:s;"),m:C("padding:",n.size.base,";;label:m;"),l:C("padding:",n.size.l,";;label:l;"),arrowLeft:C(R("padding-left",0),";;label:arrowLeft;"),arrowRight:C(R("padding-right",0),";;label:arrowRight;")}},lt=["buttonElement","buttonProps","buttonClassName","buttonContentClassName","isDisabled","arrowDisplay","children"],ct=["paddingSize"];function re(){return re=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},re.apply(null,arguments)}function dt(t){return ft(t)||ht(t)||pt(t)||ut()}function ut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pt(t,e){if(t){if(typeof t=="string")return oe(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(t,e):void 0}}function ht(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ft(t){if(Array.isArray(t))return oe(t)}function oe(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Oe(t,e){if(t==null)return{};var n,i,r=yt(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(i=0;i<l.length;i++)n=l[i],e.indexOf(n)>=0||{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function yt(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}var gt=function(e){var n=e.buttonElement,i=e.buttonProps,r=e.buttonClassName,l=e.buttonContentClassName,y=e.isDisabled,c=e.arrowDisplay,u=e.children,w=Oe(e,lt),g=i||{},x=g.paddingSize,v=Oe(g,ct),T=M("euiAccordion__button",r,v.className),E=M("euiAccordion__buttonContent",l),p=Q(),a=st(p),s=[a.euiAccordion__button,y&&a.disabled].concat(dt(x?[a[x],c==="left"&&a.arrowLeft,c==="right"&&a.arrowRight]:[]),[v.css]),b=n==="button";return I(n,re({},v,w,{className:T,css:s,type:b?"button":void 0,disabled:b?y:void 0}),I("span",{className:E},u))},bt={name:"pbbcf-isOpen",styles:"transform:rotate(90deg)!important;label:isOpen;"},mt={name:"67rr15-isClosed",styles:"transform:rotate(0deg)!important;label:isClosed;"},vt={name:"ixe809-euiAccordion__arrow",styles:"flex-shrink:0;label:euiAccordion__arrow;"},wt=function(e){var n=e.euiTheme;return{euiAccordion__arrow:vt,left:C(R("margin-right",n.size.xs),";;label:left;"),right:C(R("margin-left",n.size.xs),";;label:right;"),isClosed:mt,isOpen:bt}},xt=["arrowDisplay","arrowProps","isOpen"];function ae(){return ae=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ae.apply(null,arguments)}function Ct(t,e){if(t==null)return{};var n,i,r=Ot(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(i=0;i<l.length;i++)n=l[i],e.indexOf(n)>=0||{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Ot(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}var je=function(e){var n=e.arrowDisplay,i=n===void 0?"left":n,r=e.arrowProps,l=e.isOpen,y=Ct(e,xt),c=Q();if(i==="none")return null;var u=wt(c),w=[u.euiAccordion__arrow,u[i],l?u.isOpen:u.isClosed,r==null?void 0:r.css],g=M("euiAccordion__arrow",r==null?void 0:r.className);return I(it,ae({color:"text"},r,y,{className:g,css:w,iconType:"arrowRight"}))};je.propTypes={isOpen:f.bool.isRequired};var St={name:"7vgam2-euiAccordion-optionalAction",styles:"flex-shrink:0;label:euiAccordion;label:optionalAction;"},It={name:"osepuu-EuiAccordionTrigger",styles:"display:flex;align-items:center;label:EuiAccordionTrigger;"},Pe=function(e){var n=e.arrowDisplay,i=e.arrowProps,r=e.buttonElement,l=r===void 0?"button":r,y=e.buttonProps,c=e.buttonClassName,u=e.buttonContent,w=e.buttonContentClassName,g=e.buttonId,x=e.ariaControlsId,v=e.isDisabled,T=e.isOpen,E=e.onToggle,p=e.extraAction,a=l==="button",s=n==="none"&&!a?"left":n,b=I(je,{arrowDisplay:s,arrowProps:i,isOpen:T,onClick:E,isDisabled:v,"aria-controls":x,"aria-expanded":T,"aria-labelledby":g,"aria-hidden":a?"true":"false",tabIndex:a?-1:0}),m=I(gt,{buttonElement:l,buttonProps:y,buttonClassName:c,buttonContentClassName:w,arrowDisplay:s,isDisabled:v,id:g,"aria-controls":x,"aria-expanded":a?T:void 0,onClick:v?void 0:E},u),h=p&&I("div",{className:"euiAccordion__optionalAction",css:St},p);return I("div",{className:"euiAccordion__triggerWrapper",css:It},s==="left"&&b,m,h,s==="right"&&b)};Pe.propTypes={isOpen:f.bool.isRequired,ariaControlsId:f.string.isRequired,buttonId:f.string.isRequired,onToggle:f.func.isRequired};var Et=function(e){var n=e.isLoadingMessage,i=Q(),r=i.euiTheme;return I(ne.Fragment,null,I(G,{className:"euiAccordion__spinner",css:C({marginInlineEnd:r.size.xs},";label:EuiAccordionChildrenLoading;")}),I(ie,{size:"s"},I("p",null,n!==!0?n:I(Fe,{token:"euiAccordionChildrenLoading.message",default:"Loading"}))))},Tt={name:"1xvjonu-isLoading",styles:"align-items:center;display:flex;label:isLoading;"},At=function(e){var n=e.euiTheme;return{euiAccordion__children:C(";label:euiAccordion__children;"),isLoading:Tt,xs:C("padding:",n.size.xs,";;label:xs;"),s:C("padding:",n.size.s,";;label:s;"),m:C("padding:",n.size.base,";;label:m;"),l:C("padding:",n.size.l,";;label:l;"),xl:C("padding:",n.size.xl,";;label:xl;")}},_t=function(e){var n=e.euiTheme;return{euiAccordion__childWrapper:C("overflow:hidden;",ve,"{transition:",Ke.height," ",n.animation.normal," ",n.animation.resistance,",opacity ",n.animation.normal," ",n.animation.resistance,";}",qe(e),";;label:euiAccordion__childWrapper;"),noTransition:C(ve,"{transition:none;};label:noTransition;"),isClosed:C(R("height",0)," opacity:0;;label:isClosed;"),isOpen:C(R("height","auto")," opacity:1;;label:isOpen;")}},jt=["role","children","paddingSize","isLoading","isLoadingMessage","isOpen","initialIsOpen"];function se(){return se=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},se.apply(null,arguments)}function Se(t,e){return Rt(t)||Lt(t,e)||Nt(t,e)||Pt()}function Pt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nt(t,e){if(t){if(typeof t=="string")return Ie(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ie(t,e):void 0}}function Ie(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Lt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,l,y,c=[],u=!0,w=!1;try{if(l=(n=n.call(t)).next,e!==0)for(;!(u=(i=l.call(n)).done)&&(c.push(i.value),c.length!==e);u=!0);}catch(g){w=!0,r=g}finally{try{if(!u&&n.return!=null&&(y=n.return(),Object(y)!==y))return}finally{if(w)throw r}}return c}}function Rt(t){if(Array.isArray(t))return t}function Dt(t,e){if(t==null)return{};var n,i,r=zt(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(i=0;i<l.length;i++)n=l[i],e.indexOf(n)>=0||{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function zt(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}var Ne=function(e){var n=e.role,i=e.children,r=e.paddingSize,l=e.isLoading,y=e.isLoadingMessage,c=e.isOpen,u=e.initialIsOpen,w=Dt(e,jt),g=M("euiAccordion__children",{"euiAccordion__children-isLoading":l}),x=Q(),v=At(x),T=[v.euiAccordion__children,l&&v.isLoading,r&&r!=="none"&&v[r]],E=P.useState(!1),p=Se(E,2),a=p[0],s=p[1],b=_t(x),m=[b.euiAccordion__childWrapper,c?b.isOpen:b.isClosed,u&&!a&&c&&b.noTransition];P.useEffect(function(){u&&!c&&!a&&s(!0)},[c,u,a]);var h=P.useState(0),O=Se(h,2),L=O[0],A=O[1],D=P.useCallback(function(N){var z=N.height;return A(Math.round(z))},[]),k=P.useMemo(function(){return{blockSize:c?L:0}},[c,L]);return I("div",se({},w,{className:"euiAccordion__childWrapper",css:m,style:k,role:n,inert:c?void 0:""}),I(rt,{onResize:D},function(N){return I("div",{ref:N,className:g,css:T},l&&y?I(Et,{isLoadingMessage:y}):i)}))};Ne.propTypes={isOpen:f.bool.isRequired};var Ht=function(e){var n=e.euiTheme;return{euiAccordion:C(";label:euiAccordion;"),borders:{borders:C("&+[class*='euiAccordion-borders']{",R("border-top","none"),";};label:borders;"),horizontal:C("border-block:",n.border.thin,";;label:horizontal;"),all:C("border:",n.border.thin,";;label:all;")}}},kt=["children","className","id","role","element","buttonElement","buttonProps","buttonClassName","buttonContentClassName","buttonContent","arrowDisplay","arrowProps","extraAction","paddingSize","borders","initialIsOpen","forceState","isLoading","isLoadingMessage","isDisabled","theme"];function H(t){"@babel/helpers - typeof";return H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(t)}function le(){return le=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},le.apply(null,arguments)}function Wt(t,e){if(t==null)return{};var n,i,r=$t(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(i=0;i<l.length;i++)n=l[i],e.indexOf(n)>=0||{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function $t(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function Mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ut(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Re(i.key),i)}}function Bt(t,e,n){return e&&Ut(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ft(t,e,n){return e=J(e),qt(t,Le()?Reflect.construct(e,n||[],J(t).constructor):e.apply(t,n))}function qt(t,e){if(e&&(H(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kt(t)}function Kt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Le(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Le=function(){return!!t})()}function J(t){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(t)}function Gt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ce(t,e)}function ce(t,e){return ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ce(t,e)}function K(t,e,n){return(e=Re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Re(t){var e=Jt(t,"string");return H(e)=="symbol"?e:e+""}function Jt(t,e){if(H(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(H(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ue=(function(t){function e(){var n;Mt(this,e);for(var i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return n=Ft(this,e,[].concat(r)),K(n,"state",{isOpen:n.props.forceState?n.props.forceState==="open":n.props.initialIsOpen}),K(n,"onToggle",function(){var y=n.props.forceState;if(y){var c,u,w=!n.isOpen;(c=(u=n.props).onToggle)===null||c===void 0||c.call(u,w)}else n.setState(function(g){return{isOpen:!g.isOpen}},function(){var g,x;(g=(x=n.props).onToggle)===null||g===void 0||g.call(x,n.state.isOpen)})}),K(n,"generatedId",ot()()),n}return Gt(e,t),Bt(e,[{key:"isOpen",get:function(){return this.props.forceState?this.props.forceState==="open":this.state.isOpen}},{key:"render",value:function(){var i,r=this.props,l=r.children,y=r.className,c=r.id,u=r.role,w=r.element,g=w===void 0?"div":w,x=r.buttonElement,v=r.buttonProps,T=r.buttonClassName,E=r.buttonContentClassName,p=r.buttonContent,a=r.arrowDisplay,s=r.arrowProps,b=r.extraAction,m=r.paddingSize,h=r.borders,O=r.initialIsOpen;r.forceState;var L=r.isLoading,A=r.isLoadingMessage,D=r.isDisabled,k=r.theme,N=Wt(r,kt),z=M("euiAccordion",{"euiAccordion-isOpen":this.isOpen},y),W=Ht(k),X=[W.euiAccordion,h!=="none"&&W.borders.borders,h!=="none"&&W.borders[h]],U=(i=v==null?void 0:v.id)!==null&&i!==void 0?i:this.generatedId;return I(g,le({className:z,css:X},N),I(Pe,{ariaControlsId:c,buttonId:U,buttonElement:g==="fieldset"?"legend":x,buttonClassName:T,buttonContent:p,buttonContentClassName:E,buttonProps:v,arrowProps:s,arrowDisplay:a,isDisabled:D,isOpen:this.isOpen,onToggle:this.onToggle,extraAction:L?I(G,null):b}),I(Ne,{role:u,id:c,"aria-labelledby":U,paddingSize:m,isLoading:L,isLoadingMessage:A,isOpen:this.isOpen,initialIsOpen:O},l))}}])})(P.Component);K(ue,"defaultProps",{initialIsOpen:!1,borders:"none",paddingSize:"none",arrowDisplay:"left",isLoading:!1,isDisabled:!1,isLoadingMessage:!1,element:"div",buttonElement:"button",role:"group"});ue.propTypes={className:f.string,"aria-label":f.string,"data-test-subj":f.string,css:f.any,id:f.string.isRequired,element:f.oneOf(["div","fieldset"]),role:f.any,buttonClassName:f.string,buttonProps:f.shape({className:f.string,"aria-label":f.string,"data-test-subj":f.string,css:f.any,paddingSize:f.oneOf(["s","m","l"])}),buttonContentClassName:f.string,buttonContent:f.node,buttonElement:f.oneOf(["div","legend","button"]),arrowProps:f.any,extraAction:f.node,initialIsOpen:f.bool,onToggle:f.func,paddingSize:f.any,arrowDisplay:f.oneOf(["left","right","none"]),borders:f.oneOf(["horizontal","all","none"]),forceState:f.oneOf(["closed","open"]),isLoading:f.bool,isLoadingMessage:f.oneOfType([f.bool.isRequired,f.node.isRequired]),isDisabled:f.bool};var Qt=Ge(ue);function Ee(t){return{iri:t["@id"],label:t.prefLabel,hasChildren:t.hasChildren,parents:[]}}class pe{constructor(e,n){B(this,"axiosInstance");B(this,"apiKey");this.axiosInstance=Ae.create({baseURL:e,headers:{Accept:"application/json"}}),this.apiKey=n,this.axiosInstance.interceptors.request.use(i=>(i.params=i.params||{},i.params.apikey=this.apiKey,i.params.format="json",i))}async makeCall(e,n){return(await this.axiosInstance.get(e,n)).data}async buildHierarchyWithIri(e){const{iri:n,ontologyId:i,entityType:r,showSiblingsOnInit:l}=e;if(!i)throw Error("ontologyId has to be specified for OntoPortal API.");if(!r)throw Error("entityType has to be specified for OntoPortal API.");const y=[],c=new Map,u=new Map,w=new Set,g=new Set;function x(p){if(c.set(p["@id"],Ee(p)),p.hasChildren&&p.children.length>0){u.set(p["@id"],p.children.map(a=>({childIri:a["@id"]}))),w.add(p["@id"]),g.add(p["@id"]);for(const a of p.children)x(a)}}if(n){const p=await this.makeCall(`/ontologies/${i.toUpperCase()}/${V(r,!1)}/${encodeURIComponent(n)}/tree`,{params:{include:"@id,prefLabel,hasChildren,children",language:"EN"}});for(const a of p)y.push(a["@id"]),g.add(a["@id"]),x(a);g.add(n)}else{const p=await this.makeCall(`/ontologies/${i.toUpperCase()}/${V(r,!1)}/roots`,{params:{include:"@id,prefLabel,hasChildren",language:"EN"}});for(const a of p)y.push(a["@id"]),g.add(a["@id"])}function v(p,a){a.add(p.iri);const s=new _e(p),b=u.get(p.iri)||[];if(l)for(const m of b){if(a.has(m.childIri)){console.error(`Cyclic tree at entity "${m.childIri}".`);continue}s.addChild(v(c.get(m.childIri),a))}else for(const m of b){if(a.has(m.childIri)){console.error(`Cyclic tree at entity "${m.childIri}".`);continue}g.has(m.childIri)&&s.addChild(v(c.get(m.childIri),a))}return s.loadedChildren.length>0&&(s.expanded=!0),a.delete(p.iri),s}const T=new Set,E=y.map(p=>v(c.get(p),T)).sort((p,a)=>(p.entityData.label||p.entityData.iri).localeCompare(a.entityData.label||a.entityData.iri));return new de({parentChildRelations:u,entitiesData:c,allChildrenPresent:w,roots:E,api:new pe(this.axiosInstance.getUri(),this.apiKey),ontologyId:i,mainEntityIri:n,keepExpansionStates:e.keepExpansionStates,entityType:r})}async loadHierarchyChildren(e){const{nodeToExpand:n,ontologyId:i,entityType:r}=e;if(r==null)throw Error("entityType has to be provided to load children in an OntoPortal hierarchy.");return(await this.makeCall(`/ontologies/${i.toUpperCase()}/${V(r,!1)}/${encodeURIComponent(n.entityData.iri)}/children`,{params:{include:"@id,prefLabel,hasChildren",language:"EN"}})).collection.map(y=>Ee(y))}}class te{static fromTopConcept(e){return{iri:e.uri,label:e.label,hasChildren:e.hasChildren,parents:[]}}static fromHierarchyResult(e){return{iri:e.uri,label:e.prefLabel,hasChildren:e.narrower!=null&&e.narrower.length>0,parents:q.fromJson(e.broader)}}static fromPrefAndUriAndChildren(e,n){return{iri:e.uri,label:e.prefLabel,hasChildren:e.hasChildren,parents:q.fromJson(n)}}static fromLabelAndUriAndChildren(e,n){return{iri:e.uri,label:e.label,hasChildren:e.hasChildren,parents:q.fromJson(n)}}}class he{constructor(e){B(this,"axiosInstance");this.axiosInstance=Ae.create({baseURL:e,headers:{Accept:"application/json"}})}async makeCall(e,n){return(await this.axiosInstance.get(e,n)).data}async buildHierarchyWithIri(e){var E,p;const{iri:n,ontologyId:i,showSiblingsOnInit:r,parameter:l}=e;if(!i)throw Error("ontologyId has to be specified for SKOS API.");const y=[],c=new Map,u=new Map,w=new Set,g=new Set;if(n){const a=await this.makeCall(`/${i}/hierarchy`,{params:{uri:n,lang:"en",format:"application/json",...Z(l)}}).then(s=>Object.keys(s.broaderTransitive).map(b=>s.broaderTransitive[b]));for(const s of a){const b=te.fromHierarchyResult(s);u.set(b.iri,b),s.top&&y.push(b.iri),r||g.add(b.iri)}for(const s of a)if(s.narrower!=null){const b=[];for(const m of s.narrower){let h=u.get(m.uri);h==null?(h=te.fromLabelAndUriAndChildren(m,[s.uri]),u.set(h.iri,h)):(E=h==null?void 0:h.parents)!=null&&E.map(O=>O.value).includes(s.uri)||h!=null&&h.parents&&((p=h==null?void 0:h.parents)==null||p.push(...q.fromJson(s.uri))),b.push(h)}b.sort((m,h)=>(m.label||m.iri).localeCompare(h.label||h.iri)),c.set(s.uri,b.map(m=>({childIri:m.iri}))),w.add(s.uri)}}else{const a=await this.makeCall(`/${i}/topConcepts`,{params:{lang:"en",format:"application/json",...Z(l)}}).then(s=>s.topconcepts);for(const s of a)y.push(s.uri)}function x(a,s){s.add(a.iri);const b=new _e(a),m=c.get(a.iri)||[];if(r)for(const h of m){if(s.has(h.childIri)){console.error(`Cyclic tree at entity "${h.childIri}".`);continue}const O=u.get(h.childIri);O!=null&&b.addChild(x(O,s))}else for(const h of m){if(s.has(h.childIri)){console.error(`Cyclic tree at entity "${h.childIri}".`);continue}const O=u.get(h.childIri);O!=null&&g.has(h.childIri)&&b.addChild(x(O,s))}return b.loadedChildren.length>0&&(b.expanded=!0),s.delete(a.iri),b}const v=new Set,T=y.map(a=>x(u.get(a),v)).sort((a,s)=>(a.entityData.label||a.entityData.iri).localeCompare(s.entityData.label||s.entityData.iri));return new de({parentChildRelations:c,entitiesData:u,allChildrenPresent:w,roots:T,api:new he(this.axiosInstance.getUri()),ontologyId:i,mainEntityIri:n,keepExpansionStates:e.keepExpansionStates,parameter:l})}async loadHierarchyChildren(e){const{nodeToExpand:n,ontologyId:i,parameter:r}=e;return(await this.makeCall(`/${i}/children`,{params:{uri:n.entityData.iri,lang:"en",format:"application/json",...Z(r)}})).narrower.map(y=>te.fromPrefAndUriAndChildren(y,[n.entityData.iri]))}}function Xt(t){var ye,ge,be,me;const{apiUrl:e,backendType:n,apiKey:i,onNavigateToEntity:r,onNavigateToOntology:l,iri:y,targetIri:c,ontologyId:u,entityType:w,includeObsoleteEntities:g=j.INCLUDE_OBSOLETE_ENTITIES,preferredRoots:x=j.PREFERRED_ROOTS,keepExpansionStates:v=j.KEEP_EXPANSION_STATES,showSiblingsOnInit:T=j.SHOW_SIBLINGS_ON_INIT,useLegacy:E=j.USE_LEGACY,hierarchyWrap:p=j.WRAP,showHeader:a=j.SHOW_HEADER,showComparisonTitleInHeader:s=j.SHOW_COMPARISON_TITLE_IN_HEADER,className:b,parameter:m}=t,h=b||"ts4nfdi-hierarchy-style",[O,L]=P.useState(y),[A,D]=P.useState(c);P.useEffect(()=>{!y&&c?(L(c),D(void 0)):(L(y),D(c))},[y,c]);function k(d){let S=d.entityData.definedBy||[];return S.includes(d.ontologyId)&&(S=[]),o.jsxs("span",{style:{position:"relative",left:"16px",lineHeight:"20px"},children:[o.jsxs("span",{className:d.highlightColor?"highlight":void 0,style:{background:Ve(d.highlightColor,.2)},children:[d.childRelationToParent=="http://purl.obolibrary.org/obo/BFO_0000050"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"surroundCircle",children:" P "})," "]}),d.childRelationToParent=="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"surroundCircle",children:"I"})," "]}),o.jsx("a",{onClick:()=>{typeof d.onNavigateToEntity=="function"&&d.onNavigateToEntity(d.ontologyId,d.entityType||"",d.entityData)},style:{textAlign:"left",color:"unset",cursor:"pointer"},children:o.jsx("span",{style:{color:d.entityData.color},children:d.entityData.label||d.entityData.iri})})]}),o.jsxs("span",{children:[S.length>0&&o.jsx(o.Fragment,{children:S.map($=>o.jsxs("span",{children:[" ",o.jsx("button",{onClick:()=>{d.onNavigateToOntology&&d.onNavigateToOntology($,d.entityType||"",d.entityData)},children:o.jsx("span",{className:"ontology-badge",children:$.toUpperCase()})})]},xe()))}),d.entityData.numDescendants!=null&&d.entityData.numDescendants>0&&o.jsxs("span",{style:{color:"gray"},children:[" ","(",d.entityData.numDescendants.toLocaleString(),")"]})]})]})}const[,N]=P.useReducer(d=>d+1%Number.MAX_SAFE_INTEGER,0),[z,W]=ne.useState(!1),[X,U]=ne.useState(!1),Y=P.useMemo(()=>{switch(n){case"ols":return new we(e);case"skosmos":return new he(e);case"ontoportal":return new pe(e,i||"");default:return new we(e)}},[e,n,i]),{data:_,isSuccess:De}=et(["hierarchySemLookP",O,w,u,x,g,v,T,E,m,A,z],async function(){return A&&O?Ze(await Y.buildHierarchyWithIri({ontologyId:u,iri:O,entityType:w,preferredRoots:x,includeObsoleteEntities:g,keepExpansionStates:v,showSiblingsOnInit:!1,useLegacy:E,parameter:m}),await Y.buildHierarchyWithIri({ontologyId:u,iri:A,entityType:w,preferredRoots:x,includeObsoleteEntities:g,keepExpansionStates:v,showSiblingsOnInit:!1,useLegacy:E,parameter:m})):await Y.buildHierarchyWithIri({ontologyId:u,iri:O,entityType:w,preferredRoots:x,includeObsoleteEntities:g,keepExpansionStates:v,showSiblingsOnInit:T,useLegacy:E,parameter:m})},{refetchOnWindowFocus:!1}),ze=P.useCallback(d=>{if(!(_ instanceof de))throw Error("Hierarchy object was undefined while trying to expand a tree node. This should never happen.");_.entityType&&Ye(_.entityType)||(d.expanded=!d.expanded,d.expanded?(d.loading=!0,N(),_.fetchInformationForExpansion(d).then(()=>{d.loading=!1,N()})):(N(),_.closeNode(d)))},[_]);function fe(d,S,$){return o.jsxs("div",{children:[o.jsxs("div",{style:{position:"relative"},children:[o.jsx("div",{style:{position:"absolute",top:S.expanded?"-2px":"0",left:S.expanded?"-1px":"-3px"},children:S.entityData.hasChildren?o.jsxs("button",{style:{},onClick:()=>{ze(S)},children:[o.jsx(Ce,{type:S.expanded?"arrowDown":"arrowRight",size:"s"})," "]}):o.jsx(Ce,{type:"empty"})}),o.jsx("div",{className:"lineNodeInlet"}),o.jsx("div",{className:$?"lineAfterNodeInlet":""}),o.jsx(k,{entityData:S.entityData,childRelationToParent:S.childRelationToParent,ontologyId:d.ontologyId,entityType:d.entityType,onNavigateToEntity:typeof r=="function"?r:()=>{},onNavigateToOntology:typeof l=="function"?l:()=>{},highlightColor:S.entityData.iri==O?j.COLOR_A:S.entityData.iri==A?j.COLOR_B:""})]}),S.expanded&&o.jsx("ul",{style:{marginBlockEnd:"0",marginInlineStart:"5px"},children:S.loading?o.jsx(G,{style:{position:"relative",left:"13px",top:"5px"}}):S.loadedChildren.map((He,ke)=>o.jsx("div",{className:$?"outerLine":"",style:{paddingLeft:"1rem"},children:fe(d,He,ke<S.loadedChildren.length-1)},xe()))})]})}return o.jsx("div",{className:h,children:De&&_!=null?o.jsxs("span",{children:[a&&o.jsx(ee,{style:{overflowX:"auto",overflowY:"hidden"},borderRadius:"none",paddingSize:"s",children:o.jsxs("span",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[o.jsxs("span",{children:[O&&A&&s&&o.jsx(tt,{size:"s",children:o.jsxs("h2",{style:{maxWidth:"350px",whiteSpace:"normal",wordBreak:"break-word"},children:["Comparison of"," ",o.jsx("i",{children:((ye=_.entitiesData.get(O))==null?void 0:ye.label)||y})," ","and"," ",o.jsx("i",{children:((ge=_.entitiesData.get(A))==null?void 0:ge.label)||A})]})}),O&&A&&o.jsxs("span",{children:[o.jsx(nt,{size:"s"}),o.jsx(Qt,{buttonContent:X?"Hide Legend":"Show Legend",id:"",onToggle:d=>U(d),children:o.jsxs(ie,{style:{paddingLeft:".3em"},children:[o.jsx(F,{color:j.COLOR_UNION,children:"Common subtree"}),o.jsx("br",{}),o.jsxs(F,{color:j.COLOR_A,children:["Subtree exclusive to ",'"',((be=_.entitiesData.get(O))==null?void 0:be.label)||O,'"']}),o.jsx("br",{}),o.jsxs(F,{color:j.COLOR_B,children:["Subtree exclusive to ",'"',((me=_.entitiesData.get(A))==null?void 0:me.label)||A,'"']}),o.jsx("br",{}),o.jsx(F,{children:"Subtree independent of both"})]})})]})]}),o.jsx(at,{size:"s",onClick:()=>W(!z),children:"Reset"})]})}),o.jsx(ee,{"data-testid":"hierarchy",style:{overflowX:"auto",overflowY:"hidden"},hasShadow:!1,hasBorder:!0,borderRadius:"none",children:o.jsx("span",{children:o.jsx(ie,{style:{whiteSpace:p?"wrap":"nowrap"},children:_.roots.map((d,S)=>fe(_,d,S<_.roots.length-1))})})})]}):o.jsx(ee,{children:o.jsx(G,{})})})}function Yt(t){const e=new Je;return o.jsx(Qe,{colorMode:"light",globalStyles:!1,children:o.jsx(Xe,{client:e,children:o.jsx(Xt,{apiUrl:t.apiUrl,apiKey:t.apiKey,backendType:t.backendType,iri:t.iri,entityType:t.entityType,ontologyId:t.ontologyId,includeObsoleteEntities:t.includeObsoleteEntities,useLegacy:t.useLegacy,preferredRoots:t.preferredRoots,keepExpansionStates:t.keepExpansionStates,showSiblingsOnInit:t.showSiblingsOnInit,onNavigateToEntity:t.onNavigateToEntity,onNavigateToOntology:t.onNavigateToOntology,parameter:t.parameter,hierarchyWrap:t.hierarchyWrap,showHeader:t.showHeader,showComparisonTitleInHeader:t.showComparisonTitleInHeader,className:t.className,targetIri:t.targetIri})})})}const Te=new WeakMap;function Vt(t,e){let n=Te.get(e);n||(n=Me.createRoot(e),Te.set(e,n)),n.render(o.jsx(Yt,{...t}))}window.ts4nfdiWidgets={...window.ts4nfdiWidgets,createHierarchy:Vt};export{Xt as H,Vt as c};
